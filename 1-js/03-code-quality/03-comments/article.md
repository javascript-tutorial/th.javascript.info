# คอมเม้นต์ (Comments)

เช่นที่เราทราบจากบท <info:structure> คอมเม้นแบบบรรทัดเดียว: เริ่มต้นด้วย `//` และแบบหลายบรรทัด: `/* ... */`

เรามักจะใช้คอมเม้นเพื่ออธิบายวิธีการและเหตุผลที่โค้ดทำงานได้

ในครั้งแรกที่เห็น การใช้คอมเม้นอาจดูเป็นเรื่องชัดเจน แต่มือใหม่ในการเขียนโปรแกรมมักใช้คอมเม้นต์ในทางที่ไม่ถูกต้อง

## คอมเม้นต์ที่ไม่เป็นประโยชน์ (Bad comments)

มือใหม่ในการเขียนโปรแกรมมักนิยมใช้ความคิดเห็นเพื่ออธิบาย "กระบวนการที่เกิดขึ้นในโค้ด" อย่างเช่น:

```js
// โค้ดนี้จะดำเนินการเช่นนี้ (...) และเช่นนั้น (...)
// ...และใครจะรู้ว่ามีอะไรเพิ่มเติมอีก...
very;
complex;
code;
```

แต่ในโค้ดที่มีคุณภาพ ปริมาณของคอมเม้นต์แนวนี้ควรจะน้อยลง เพราะโค้ดที่ดีควรเข้าใจง่ายโดยไม่ต้องพึ่งคอมเม้นต์

มีหลักคิดน่าสนใจว่า "หากโค้ดเข้าใจยากจนต้องพึ่งพาคอมเม้นต์ ควรพิจารณาเขียนใหม่เพื่อความเข้าใจง่ายขึ้นแทน"

### สูตร: การสร้างฟังก์ชันแยก

บางครั้งการแทนที่ส่วนของโค้ดด้วยฟังก์ชันนั้นเป็นประโยชน์ เช่นตัวอย่างนี้:

```js
function showPrimes(n) {
  nextPrime:
  for (let i = 2; i < n; i++) {

*!*
    // ตรวจสอบว่า i คือจำนวนเฉพาะหรือไม่
    for (let j = 2; j < i; j++) {
      if (i % j == 0) continue nextPrime;
    }
*/!*

    alert(i);
  }
}
```

โดยการแยกฟังก์ชัน `isPrime` ออกมา กลายเป็นวิธีที่ดีขึ้น:


```js
function showPrimes(n) {

  for (let i = 2; i < n; i++) {
    *!*if (!isPrime(i)) continue;*/!*

    alert(i);  
  }
}

function isPrime(n) {
  for (let i = 2; i < n; i++) {
    if (n % i == 0) return false;
  }

  return true;
}
```

เราจึงสามารถเข้าใจโค้ดได้โดยไม่ยากนัก ฟังก์ชันเองก็ตัวมันเองได้ว่าทำอะไร โค้ดประเภทนี้เรียกว่า *สามารถอธิบายตัวเองได้ (self-descriptive)*

### สูตร: การสร้างฟังก์ชัน

หากเรามีโค้ดที่ยาวประมาณนี้:

```js
// ตรงนี้เราเติมวิสกี้
for(let i = 0; i < 10; i++) {
  let drop = getWhiskey();
  smell(drop);
  add(drop, glass);
}

// ตรงนี้เราเติมน้ำผลไม้
for(let t = 0; t < 3; t++) {
  let tomato = getTomato();
  examine(tomato);
  let juice = press(tomato);
  add(juice, glass);
}

// ...
```

การปรับปรุงโค้ดให้เป็นฟังก์ชันอาจจะเป็นวิธีที่ดีกว่า เช่น:

```js
addWhiskey(glass);
addJuice(glass);

function addWhiskey(container) {
  for(let i = 0; i < 10; i++) {
    let drop = getWhiskey();
    //...
  }
}

function addJuice(container) {
  for(let t = 0; t < 3; t++) {
    let tomato = getTomato();
    //...
  }
}
```

อีกครั้ง ฟังก์ชันเองก็บอกว่าตัวมันเองจะทำอะไร ไม่มีความจำเป็นต้องใส่คอมเม้น นอกจากนี้โครงสร้างโค้ดยังดีขึ้นเมื่อถูกแยก ชัดเจนว่าฟังก์ชันแต่ละตัวทำอะไร รับอะไรและคืนค่าอะไร ซึ่งเป็นสิ่งที่เราต้องการในการเขียนโค้ดที่ดี

ในความเป็นจริง เราไม่สามารถหลีกเลี่ยงคอมเม้นได้ เช่น มีอัลกอริทึมที่ซับซ้อน และมี "การปรับปรุง (tweaks)" เพื่อเพิ่มประสิทธิภาพ แต่โดยทั่วไปเราควรพยายามเขียนให้โค้ดง่ายต่อความเข้าใจและสามารถอธิบายตัวเองได้ว่าทำอะไร

## คอมเม้นที่มีประโยชน์ (Good comments)

เราเห็นคอมเม้นที่ไม่เป็นประโยชน์มากันบ้างแล้ว ทีนี้มาดูคอมเม้นที่มีประโยชน์กัน

อธิบายโครงสร้าง (Architecture)
: ให้ภาพรวมเกี่ยวกับองค์ประกอบต่างๆ ว่ามีการโต้ตอบกันอย่างไร และการควบคุมกระบวนการต่างๆ ที่เกิดขึ้นในสถานการณ์ต่างๆ อย่างกระชับได้ โดยทั่วไปแล้ว เราสามารถใช้ภาษา [UML](http://wikipedia.org/wiki/Unified_Modeling_Language) เพื่อสร้างแผนภาพโครงสร้าง  จะช่วยอธิบายโค้ดให้เข้าใจง่ายยิ่งขึ้น และเป็นประโยชน์อย่างมากในการเรียนรู้เกี่ยวกับโค้ด

การเขียนเอกสารและพารามิเตอร์ของการใช้งานฟังก์ชัน
: มีไวยากรณ์แบบพิเศษเรียกว่า [JSDoc](http://en.wikipedia.org/wiki/JSDoc) ที่ใช้ในการเขียนเอกสารให้ฟังก์ชัน: การใช้งาน พารามิเตอร์ และค่าที่ส่งกลับ (returned value)

ตัวอย่างเช่น
```js
/**
 * ฟังก์ชันที่ใช้ในการยกกำลัง x ด้วย n
 *
 * @param {number} x ตัวเลขที่จะนำไปยกกำลัง
 * @param {number} n ค่าสั่งยกกำลัง ต้องเป็นจำนวนเต็มบวกเท่านั้น
 * @return {number} ค่า x ยกกำลัง n
 */
function pow(x, n) {
  ...
}
```

คอมเม้นดังกล่าวช่วยให้เราเข้าใจวัตถุประสงค์ของฟังก์ชันและใช้งานได้อย่างถูกต้องโดยไม่ต้องดูในโค้ดของฟังก์ชัน

อย่างไรก็ตาม โปรแกรมต่างๆ เช่น [WebStorm](https://www.jetbrains.com/webstorm/) สามารถเข้าใจคำอธิบายแบบนี้ได้และนำมาใช้ในการให้คำแนะนำต่างๆ เช่น autocomplete และการตรวจสอบโค้ดอัตโนมัติว่าเราใช้งานฟังก์ชันอย่างถูกต้องหรือไม่

นอกจากนี้ยังมีเครื่องมืออื่นๆ เช่น [JSDoc 3](https://github.com/jsdoc3/jsdoc) ที่สามารถสร้างเอกสาร HTML จากความคิดเห็นได้ คุณสามารถอ่านข้อมูลเพิ่มเติมเกี่ยวกับ JSDoc ได้ที่ <http://usejsdoc.org/>.

ทำไมต้องแก้ปัญหาแบบนี้?
: สิ่งที่เขียนเป็นสิ่งสำคัญ แต่สิ่งที่ไม่เขียนอาจจะสำคัญกว่าอีกเพื่อให้เข้าใจว่าเกิดอะไรขึ้น

    ทำไมต้องแก้ปัญหาในวิธีนี้และไม่ใช้วิธีอื่น ๆ ที่อาจจะเป็นไปได้หลายวิธี โดยเฉพาะเมื่อวิธีที่ใช้นั้นไม่ใช่วิธีที่เหมาะสมสุดๆ โค้ดไม่ให้คำตอบ

    การไม่มีคอมเม้นอาจทำให้เกิดสถานการณ์ต่อไปนี้ได้:
    1. คุณ (หรือเพื่อนร่วมงานของคุณ) เปิดโค้ดที่เขียนไว้เมื่อก่อน และเห็นว่ามัน "ไม่เหมาะสม"
    2. คุณคิด: "เมื่อก่อนฉันโง่มาก แต่ตอนนี้ฉันฉลาดขึ้นแล้ว", แล้วทำการเขียนใหม่โดยใช้วิธีที่ "ชัดเจนและถูกต้องกว่า" แต่...
    3. ...การต้องการเขียนใหม่นั้นดี แต่ในขณะเดียวกัน คุณเห็นว่าวิธี "ชัดเจน" นั้นมีข้อจำกัด และคุณจำได้ว่าทำไมมันเป็นเช่นนั้นเพราะคุณเคยลองไปแล้ว คุณกลับไปใช้วิธีที่ถูกต้องแต่เสียเวลาไปเพิ่มเติม

    การเขียนคอมเม้นเพื่ออธิบายวิธีการแก้ปัญหาเป็นสิ่งที่สำคัญมาก มันช่วยให้เราสามารถพัฒนาโค้ดให้ถูกต้องตามวิธีที่เหมาะสมได้

มีคุณสมบัติละเอียดอ่อนในโค้ดหรือไม่? มันถูกใช้อย่างไรบ้าง?
: หากโค้ดมีคสาทละเอียดอ่อนและตรงข้ามกับสิ่งที่รู้มา ควรจะเขียนคอมเม้นเพื่อช่วยให้เข้าใจได้ง่ายขึ้น ว่าแต่คุณสามารถนำคุณสมบัตินั้นไปใช้งานอย่างไรได้บ้าง ในการเขียนโค้ด มีการใช้ฟีเจอร์ที่ซับซ้อนและซ่อนเร้นอยู่บ้าง ดังนั้นการเพิ่มความชัดเจนในการใช้งานฟีเจอร์นั้นๆ จึงเป็นสิ่งที่สำคัญมากๆ

## สรุป

เคล็ดลับสำคัญของนักพัฒนาที่ดีคือการเขียนคอมเม้น: ไม่ว่ามันจะมีหรือไม่มี

เป็นเครื่องช่วยที่ดีในการบำรุงรักษาโค้ด ช่วยให้เราสามารถกลับมาใช้โค้ดได้อย่างมีประสิทธิภาพและช่วยให้เราเข้าใจโค้ดได้ง่ายขึ้น

**ควรเขียนคอมเม้นดังต่อไปนี้:**

- โครงสร้างโดยรวมและมุมมองระดับสูง
- การใช้งานฟังก์ชั่น
- วิธีการแก้ปัญหาที่สำคัญโดยเฉพาะเมื่อมีการใช้วิธีที่ไม่เหมาะสม

**ควรหลีกเลี่ยงเขียนคอมเม้นดังต่อไปนี้:**

- การอธิบาย "วิธีการทำงาน" และ "สิ่งที่โค้ดทำ"
- หากสามารถทำให้โค้ดอ่านเข้าใจได้ง่าย และเป็นระเบียบ ก็ไม่จำเป็นต้องมีคอมเม้น

คอมเม้นในโค้ดยังสามารถใช้สำหรับเครื่องมือสร้างเอกสารอัตโนมัติ เช่น JSDoc3 โดยเครื่องมือเหล่านี้อ่านคำอธิบายแล้วสร้างเอกสาร HTML หรือเอกสารอื่นๆ ตามรูปแบบที่ต้องการ
