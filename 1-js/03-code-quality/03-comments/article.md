# ความคิดเห็น (Comments)

อย่างที่เรารู้จากบท <info:structure> ความคิดเห็นสามารถเป็นบรรทัดเดียว: เริ่มต้นด้วย `//` และหลายบรรทัด: `/* ... */`

โดยปกติเราใช้ความคิดเห็นเพื่ออธิบายว่าโค้ดทำงานอย่างไรและทำไม

ที่แรกเห็น การใส่ความคิดเห็นอาจดูชัดเจน แต่มือใหม่ในการเขียนโปรแกรมมักใช้มันผิดๆ

## ความคิดเห็นแย่ๆ

มือใหม่มักจะใช้ความคิดเห็นเพื่ออธิบาย "ว่าอะไรกำลังเกิดขึ้นในโค้ด" แบบนี้:

```js
// โค้ดนี้จะทำสิ่งนี้ (...) และอันนั้น (...)
// ...แล้วก็ใครจะไปรู้ว่ามีอะไรอีก...
very;
complex;
code;
```

แต่ในโค้ดที่ดี ปริมาณความคิดเห็น "อธิบาย" แบบนี้ควรน้อยที่สุด จริงๆ แล้ว โค้ดควรอ่านเข้าใจได้ง่ายโดยไม่ต้องมีมัน

มีกฎเหล็กที่ยอดเยี่ยมเกี่ยวกับเรื่องนี้: "ถ้าโค้ดไม่ชัดเจนจนต้องใส่ความคิดเห็น เราอาจควรเขียนใหม่แทน" 

### เคล็ดลับ: แยกออกเป็นฟังก์ชัน

บางครั้งการแทนที่โค้ดด้วยฟังก์ชันก็มีประโยชน์ เช่นในที่นี้:

```js
function showPrimes(n) {
  nextPrime:
  for (let i = 2; i < n; i++) {

*!*
    // ตรวจว่า i เป็นจำนวนเฉพาะไหม
    for (let j = 2; j < i; j++) {
      if (i % j == 0) continue nextPrime;
    }
*/!*

    alert(i);
  }
}
```

ตัวเลือกที่ดีกว่าคือแยกออกมาเป็นฟังก์ชัน `isPrime`:


```js
function showPrimes(n) {

  for (let i = 2; i < n; i++) {
    *!*if (!isPrime(i)) continue;*/!*

    alert(i);  
  }
}

function isPrime(n) {
  for (let i = 2; i < n; i++) {
    if (n % i == 0) return false;
  }

  return true;
}
```

ตอนนี้เราเข้าใจโค้ดได้ง่ายแล้ว ตัวฟังก์ชันเองกลายเป็นความคิดเห็น โค้ดแบบนี้เรียกว่า *self-descriptive*

### เคล็ดลับ: สร้างฟังก์ชัน

และถ้าเรามี "แผ่นโค้ด" ยาวๆ แบบนี้:

```js
// เพิ่มวิสกี้ตรงนี้
for(let i = 0; i < 10; i++) {
  let drop = getWhiskey();
  smell(drop);
  add(drop, glass);
}

// เพิ่มน้ำผลไม้ตรงนี้
for(let t = 0; t < 3; t++) {
  let tomato = getTomato();
  examine(tomato);
  let juice = press(tomato);
  add(juice, glass);
}

// ...
```

ลองรีแฟกเตอร์ให้เป็นฟังก์ชันอาจจะดีกว่า แบบนี้:

```js
addWhiskey(glass);
addJuice(glass);

function addWhiskey(container) {
  for(let i = 0; i < 10; i++) {
    let drop = getWhiskey();
    //...
  }
}

function addJuice(container) {
  for(let t = 0; t < 3; t++) {
    let tomato = getTomato();
    //...
  }
}
```

อีกครั้ง ฟังก์ชันเองก็บอกได้ว่ากำลังเกิดอะไรขึ้น ไม่ต้องใส่ความคิดเห็นอะไร และโครงสร้างโค้ดก็ดีขึ้นเมื่อแยกมัน มันชัดเจนว่าแต่ละฟังก์ชันทำอะไร รับอะไรเข้ามา และส่งอะไรกลับ

ในความเป็นจริง เราไม่สามารถหลีกเลี่ยงความคิดเห็นแบบ "อธิบาย" ได้ทั้งหมด มีอัลกอริทึมที่ซับซ้อน และมี "กลเม็ด" ที่ฉลาดเพื่อปรับให้เหมาะสม แต่โดยทั่วไปแล้ว เราควรพยายามรักษาให้โค้ดเรียบง่ายและอธิบายตัวเอง

## ความคิดเห็นที่ดี

งั้นความคิดเห็นแบบอธิบายมักจะแย่สินะ แล้วความคิดเห็นแบบไหนดีล่ะ?

อธิบายสถาปัตยกรรม
: ให้ภาพรวมระดับสูงของคอมโพเนนต์ ว่ามันโต้ตอบกันอย่างไร อะไรคือลำดับการควบคุมในสถานการณ์ต่างๆ สรุปคือมุมมองแบบ bird's eye ของโค้ด มีภาษาพิเศษ [UML](http://wikipedia.org/wiki/Unified_Modeling_Language) เพื่อสร้างแผนภาพสถาปัตยกรรมระดับสูงที่อธิบายโค้ด ควรศึกษาอย่างยิ่ง

เอกสารพารามิเตอร์ฟังก์ชันและการใช้งาน
: มี syntax พิเศษ [JSDoc](http://en.wikipedia.org/wiki/JSDoc) เพื่อเขียนเอกสารประกอบฟังก์ชัน: การใช้งาน พารามิเตอร์ ค่าที่ส่งกลับ  

ตัวอย่างเช่น:
```js
/**
 * ส่งค่า x ยกกำลัง n กลับ
 *
 * @param {number} x ตัวเลขที่จะยกกำลัง
 * @param {number} n เลขกำลัง ต้องเป็นจำนวนเต็มบวก
 * @return {number} x ยกกำลัง n
 */
function pow(x, n) {
  ...
}
```

ความคิดเห็นแบบนี้ทำให้เราเข้าใจจุดประสงค์ของฟังก์ชัน และใช้มันได้ถูกต้องโดยไม่ต้องดูในโค้ด

อีกอย่าง เอดิเตอร์หลายตัวเช่น [WebStorm](https://www.jetbrains.com/webstorm/) สามารถเข้าใจความคิดเห็นแบบนี้ได้ และใช้เพื่อทำออโต้คอมพลีตและตรวจสอบโค้ดบางส่วนโดยอัตโนมัติ

นอกจากนี้ยังมีเครื่องมือเช่น [JSDoc 3](https://github.com/jsdoc/jsdoc) ที่สามารถสร้างเอกสาร HTML จากความคิดเห็นได้ อ่านข้อมูลเพิ่มเติมเกี่ยวกับ JSDoc ได้ที่ <https://jsdoc.app>

ทำไมงานถึงแก้ปัญหาแบบนี้?
: สิ่งที่เขียนลงไปนั้นสำคัญ แต่สิ่งที่*ไม่ได้*เขียนอาจสำคัญยิ่งกว่าในการทำความเข้าใจว่ากำลังเกิดอะไรขึ้น ทำไมงานถึงแก้ปัญหาแบบนี้อย่างเจาะจง? โค้ดไม่ได้ให้คำตอบ

    ถ้ามีหลายวิธีในการแก้ปัญหา ทำไมถึงใช้วิธีนี้? โดยเฉพาะอย่างยิ่งเมื่อมันไม่ใช่วิธีที่ชัดเจนที่สุด

    หากไม่มีความคิดเห็นแบบนี้ สถานการณ์ต่อไปนี้อาจเกิดขึ้นได้:
    1. คุณ (หรือเพื่อนร่วมงานของคุณ) เปิดโค้ดที่เขียนไว้นานแล้ว และเห็นว่ามัน "ไม่เหมาะสม"
    2. คุณคิด: "ตอนนั้นฉันโง่จัง แต่ตอนนี้ฉันฉลาดขึ้นมากแล้ว" แล้วเขียนใหม่โดยใช้ตัวเลือกที่ "ชัดเจนและถูกต้องกว่า"  
    3. ...ความต้องการเขียนใหม่เป็นเรื่องดี แต่ในกระบวนการนั้น คุณพบว่าวิธีที่ "ชัดเจนกว่า" จริงๆ แล้วขาดอะไรบางอย่าง คุณยังจำได้เลือนรางว่าทำไม เพราะคุณเคยลองทำมานานแล้ว คุณย้อนกลับไปใช้ตัวเลือกที่ถูกต้อง แต่เสียเวลาไปแล้ว

    ความคิดเห็นที่อธิบายวิธีแก้ปัญหานั้นสำคัญมาก มันช่วยให้การพัฒนาดำเนินไปในทิศทางที่ถูกต้อง

โค้ดมีรายละเอียดอะไรที่ซับซ้อนไหม? มันถูกใช้ที่ไหน?
: ถ้าโค้ดมีอะไรที่ซับซ้อนและขัดแย้งกับสามัญสำนึก มันควรค่าแก่การใส่ความคิดเห็นอย่างยิ่ง

## สรุป

สัญญาณสำคัญของนักพัฒนาที่ดีคือความคิดเห็น: ทั้งการมีอยู่และการไม่มีอยู่ของมัน

ความคิดเห็นที่ดีช่วยให้เราดูแลรักษาโค้ดได้ดี กลับมาดูมันหลังจากพักไปและใช้มันได้อย่างมีประสิทธิภาพมากขึ้น

**ใส่ความคิดเห็นเรื่องนี้:**

- สถาปัตยกรรมโดยรวม ภาพรวมระดับสูง
- การใช้ฟังก์ชัน
- วิธีการแก้ปัญหาที่สำคัญ โดยเฉพาะอย่างยิ่งเมื่อมันไม่ชัดเจนในทันที

**หลีกเลี่ยงความคิดเห็น:**

- ที่บอกว่า "โค้ดทำงานอย่างไร" และ "มันทำอะไร"
- ใส่มันก็ต่อเมื่อเป็นไปไม่ได้ที่จะทำให้โค้ดเรียบง่ายและอธิบายตัวเองจนไม่ต้องใช้ความคิดเห็น  

ความคิดเห็นยังใช้สำหรับเครื่องมือสร้างเอกสารอัตโนมัติเช่น JSDoc3: พวกมันจะอ่านความคิดเห็นและสร้างเอกสาร HTML (หรือเอกสารในรูปแบบอื่น)
