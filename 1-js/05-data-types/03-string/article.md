# สตริง (Strings)

ในภาษา JavaScript ข้อมูลที่เป็นตัวอักษรจะถูกเก็บไว้ในรูปแบบของสตริง ไม่มีประเภทข้อมูลแยกต่างหากสำหรับอักขระเดี่ยว

รูปแบบภายในของสตริงจะเป็น [UTF-16](https://en.wikipedia.org/wiki/UTF-16) เสมอ ไม่ได้ขึ้นอยู่กับการเข้ารหัสของหน้าเว็บ

## เครื่องหมายคำพูด

มาทบทวนประเภทของเครื่องหมายคำพูดกัน

สตริงสามารถอยู่ภายในเครื่องหมายคำพูดเดี่ยว เครื่องหมายคำพูดคู่ หรือเครื่องหมาย backticks ได้:

```js
let single = 'single-quoted';
let double = "double-quoted";

let backticks = `backticks`;
```

เครื่องหมายคำพูดเดี่ยวและคู่มีลักษณะการทำงานเหมือนกัน แต่เครื่องหมาย backticks ช่วยให้เราสามารถแทรกนิพจน์ (expression) ใดๆ ลงในสตริงได้ โดยครอบด้วย `${…}`:

```js run
function sum(a, b) {
  return a + b;
}

alert(`1 + 2 = ${sum(1, 2)}.`); // 1 + 2 = 3.
```

ข้อดีอีกอย่างของการใช้ backticks คือสามารถทำให้สตริงมีหลายบรรทัดได้:

```js run
let guestList = `รายชื่อแขก:
 * สมชาย
 * สมหญิง
 * สมศรี
`;

alert(guestList); // แสดงรายชื่อแขกหลายบรรทัด
```

ดูเป็นธรรมชาติใช่ไหมล่ะ? แต่เครื่องหมายคำพูดเดี่ยวหรือคู่ไม่สามารถทำแบบนี้ได้

ถ้าเราใช้เครื่องหมายคำพูดเดี่ยวหรือคู่และพยายามใช้หลายบรรทัด จะเกิดข้อผิดพลาด:

```js run
let guestList = "รายชื่อแขก: // Error: Unexpected token ILLEGAL
  * สมชาย";
```

เครื่องหมายคำพูดเดี่ยวและคู่มีมาตั้งแต่ยุคแรกๆ ของการสร้างภาษา ซึ่งตอนนั้นยังไม่ได้คำนึงถึงความต้องการในการใช้สตริงหลายบรรทัด ส่วน backticks เพิ่งมาในภายหลังจึงมีความสามารถที่หลากหลายกว่า

backticks ยังช่วยให้เราสามารถระบุ "ฟังก์ชันเทมเพลต" (template function) ก่อน backtick แรกได้ด้วย ไวยากรณ์คือ: <code>func&#96;string&#96;</code> ฟังก์ชัน `func` จะถูกเรียกโดยอัตโนมัติ รับสตริงและนิพจน์ที่แทรกเข้ามาและสามารถประมวลผลได้ คุณลักษณะนี้เรียกว่า "tagged templates" ซึ่งพบเห็นได้ไม่บ่อยนัก แต่คุณสามารถอ่านเพิ่มเติมได้ที่ MDN: [Template literals](mdn:/JavaScript/Reference/Template_literals#Tagged_templates)

## อักขระพิเศษ

ยังคงสามารถสร้างสตริงหลายบรรทัดด้วยเครื่องหมายคำพูดเดี่ยวและคู่ได้ โดยใช้ "อักขระขึ้นบรรทัดใหม่" (newline character) ซึ่งเขียนเป็น `\n` ที่แสดงถึงการขึ้นบรรทัดใหม่:

```js run
let guestList = "รายชื่อแขก:\n * สมชาย\n * สมหญิง\n * สมศรี";

alert(guestList); // แสดงรายชื่อแขกหลายบรรทัด เหมือนกับตัวอย่างก่อนหน้า
```

ตัวอย่างที่ง่ายกว่านี้ สองบรรทัดต่อไปนี้เท่ากัน แค่เขียนต่างกัน:

```js run
let str1 = "สวัสดี\nชาวโลก"; // สองบรรทัดโดยใช้ "สัญลักษณ์ขึ้นบรรทัดใหม่"

// สองบรรทัดโดยใช้การขึ้นบรรทัดปกติและ backticks
let str2 = `สวัสดี
ชาวโลก`;

alert(str1 == str2); // true
```

มีอักขระพิเศษอื่นๆ ที่พบได้น้อยกว่า:

| อักขระ | คำอธิบาย |
|-----------|-------------|
|`\n`|ขึ้นบรรทัดใหม่|
|`\r`|ในไฟล์ข้อความของ Windows การรวมกันของอักขระสองตัว `\r\n` แสดงถึงการขึ้นบรรทัดใหม่ ในขณะที่ระบบปฏิบัติการที่ไม่ใช่ Windows จะใช้แค่ `\n` นี่เป็นเพราะเหตุผลทางประวัติศาสตร์ ซอฟต์แวร์ Windows ส่วนใหญ่ก็เข้าใจ `\n` เช่นกัน |
|`\'`, `\"`, <code>\\`</code>|เครื่องหมายคำพูด|
|`\\`|แบ็คสแลช|
|`\t`|แท็บ|
|`\b`, `\f`, `\v`| Backspace, Form Feed, Vertical Tab -- กล่าวถึงเพื่อความครบถ้วน มาจากยุคเก่า ไม่ได้ใช้ในปัจจุบัน (คุณสามารถลืมมันไปได้เลย) |

ดังที่คุณเห็น อักขระพิเศษทั้งหมดเริ่มต้นด้วยเครื่องหมายแบ็คสแลช `\` ซึ่งเรียกว่า "อักขระหลบ" (escape character)

เนื่องจากมันพิเศษมาก ถ้าเราต้องการแสดงแบ็คสแลชจริงๆ `\` ในสตริง เราต้องเขียนมันสองครั้ง:

```js run
alert( `แบ็คสแลช: \\` ); // แบ็คสแลช: \
```

เครื่องหมายคำพูดที่ "หลบ" (escaped) `\'`, `\"`, <code>\\`</code> ใช้เพื่อแทรกเครื่องหมายคำพูดลงในสตริงที่ใช้เครื่องหมายคำพูดแบบเดียวกัน

ตัวอย่างเช่น:

```js run
alert( 'ฉัน*!*\'*/!*คือ วอลรัส!' ); // *!*ฉัน'*/!*คือ วอลรัส!
```

ดังที่คุณเห็น เราต้องนำเครื่องหมายแบ็คสแลช `\'` มาวางไว้หน้าเครื่องหมายคำพูดภายใน มิฉะนั้นมันจะบ่งบอกว่าเป็นจุดสิ้นสุดของสตริง

แน่นอนว่า เฉพาะเครื่องหมายคำพูดที่เหมือนกับเครื่องหมายที่ล้อมรอบเท่านั้นที่ต้องหลบ ดังนั้น วิธีที่สวยงามกว่าคือเปลี่ยนไปใช้เครื่องหมายคำพูดคู่หรือ backticks แทน:

```js run
alert( "ฉัน'คือ วอลรัส!" ); // ฉัน'คือ วอลรัส!
```

นอกเหนือจากอักขระพิเศษเหล่านี้ ยังมีสัญกรณ์พิเศษสำหรับรหัส Unicode `\u…` ซึ่งใช้ไม่บ่อยนักและอยู่ในบทเสริมเกี่ยวกับ [Unicode](info:unicode)

## ความยาวของสตริง

คุณสมบัติ `length` คือความยาวของสตริง:

```js run
alert( `สวัสดี\n`.length ); // 5
```

สังเกตว่า `\n` เป็น "อักขระพิเศษ" เดียว ดังนั้นความยาวจึงเป็น `5` จริงๆ

```warn header="`length` เป็นคุณสมบัติ"
ผู้ที่มีพื้นฐานจากภาษาอื่นบางครั้งอาจพิมพ์ผิดโดยเรียก `str.length()` แทนที่จะเป็นแค่ `str.length` ซึ่งไม่ทำงาน

โปรดทราบว่า `str.length` เป็นคุณสมบัติเชิงตัวเลข ไม่ใช่ฟังก์ชัน ไม่จำเป็นต้องเพิ่มวงเล็บหลังมัน ไม่ใช่ `.length()` แต่เป็น `.length`
```

## การเข้าถึงอักขระ

เพื่อเข้าถึงอักขระที่ตำแหน่ง `pos` ให้ใช้วงเล็บเหลี่ยม `[pos]` หรือเรียกเมธอด [str.at(pos)](mdn:js/String/at) อักขระแรกเริ่มจากตำแหน่งศูนย์:

```js run
let str = `สวัสดี`;

// อักขระแรก
alert( str[0] ); // ส
alert( str.at(0) ); // ส

// อักขระสุดท้าย
alert( str[str.length - 1] ); // ี
alert( str.at(-1) );
```

ดังที่คุณเห็น เมธอด `.at(pos)` มีข้อดีคือสามารถใช้ตำแหน่งเชิงลบได้ ถ้า `pos` เป็นลบ จะนับจากท้ายสตริง

ดังนั้น `.at(-1)` หมายถึงอักขระสุดท้าย และ `.at(-2)` คืออักขระก่อนหน้านั้น เป็นต้น

วงเล็บเหลี่ยมจะคืนค่า `undefined` เสมอสำหรับดัชนีที่เป็นลบ ตัวอย่างเช่น:

```js run
let str = `สวัสดี`;

alert( str[-2] ); // undefined
alert( str.at(-2) ); // ด
```

เราสามารถวนลูปผ่านอักขระโดยใช้ `for..of` ได้ด้วย:

```js run
for (let char of "สวัสดี") {
  alert(char); // ส,วั,ส,ดี,ี (char กลายเป็น "ส", แล้ว "วั", แล้ว "ส" และอื่นๆ)
}
```

## สตริงไม่สามารถเปลี่ยนแปลงได้

สตริงไม่สามารถเปลี่ยนแปลงได้ใน JavaScript เป็นไปไม่ได้ที่จะเปลี่ยนอักขระ

ลองดูตัวอย่างนี้เพื่อแสดงให้เห็นว่ามันไม่ทำงาน:

```js run
let str = 'สวัสดี';

str[0] = 'ห'; // เกิดข้อผิดพลาด
alert( str[0] ); // ไม่ทำงาน
```

วิธีแก้ปัญหาทั่วไปคือการสร้างสตริงใหม่ทั้งหมดและ