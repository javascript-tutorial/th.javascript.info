# บทนำสู่ JavaScript

มาดูกันว่า JavaScript มีอะไรพิเศษ เราสามารถทำอะไรได้บ้างด้วยมัน และเทคโนโลยีอื่นๆ ใดที่ทำงานเข้ากันได้ดีกับมัน

## JavaScript คืออะไร?

*JavaScript* ถูกสร้างขึ้นมาเพื่อ "ทำให้หน้าเว็บมีชีวิตชีวา"

โปรแกรมที่เขียนด้วยภาษานี้เรียกว่า *สคริปต์* สามารถเขียนลงไปใน HTML ของหน้าเว็บได้โดยตรง และรันโดยอัตโนมัติเมื่อหน้าเว็บโหลด

สคริปต์จะถูกเตรียมและรันเป็นข้อความธรรมดา ไม่จำเป็นต้องมีการจัดเตรียมหรือคอมไพล์เป็นพิเศษเพื่อรัน

ในแง่นี้ JavaScript แตกต่างจากภาษา [Java](https://en.wikipedia.org/wiki/Java_(programming_language)) อย่างมาก

```smart header="ทำไมถึงถูกเรียกว่า <u>Java</u>Script?"
เมื่อ JavaScript ถูกสร้างขึ้น มันมีชื่อเดิมว่า "LiveScript" แต่ในตอนนั้น Java เป็นที่นิยมมาก จึงมีการตัดสินใจว่าการวางตำแหน่งภาษาใหม่เป็น "น้องชาย" ของ Java จะช่วยได้

แต่เมื่อมันพัฒนาขึ้นเรื่อยๆ JavaScript ก็กลายเป็นภาษาที่เป็นอิสระโดยสิ้นเชิง มีข้อกำหนดเป็นของตัวเองชื่อ [ECMAScript](http://en.wikipedia.org/wiki/ECMAScript) และตอนนี้ไม่มีความเกี่ยวข้องใดๆ กับ Java อีกต่อไป
```

ปัจจุบัน JavaScript สามารถรันได้ไม่เพียงแค่ในเบราว์เซอร์ แต่ยังรันบนเซิร์ฟเวอร์ หรือบนอุปกรณ์ใดๆ ที่มีโปรแกรมพิเศษที่เรียกว่า [the JavaScript engine](https://en.wikipedia.org/wiki/JavaScript_engine)

เบราว์เซอร์มี engine ฝังตัวอยู่ บางครั้งเรียกว่า "JavaScript virtual machine"

Engine ต่างๆ มีชื่อเรียก (codename) ที่ต่างกัน เช่น:

- [V8](https://en.wikipedia.org/wiki/V8_(JavaScript_engine)) -- ใน Chrome, Opera และ Edge
- [SpiderMonkey](https://en.wikipedia.org/wiki/SpiderMonkey) -- ใน Firefox
- ...มี codename อื่นๆ อีก เช่น "Chakra" สำหรับ IE, "JavaScriptCore", "Nitro" และ "SquirrelFish" สำหรับ Safari เป็นต้น

คำศัพท์ข้างต้นเป็นสิ่งที่ดีที่ควรจำไว้ เพราะมันถูกใช้ในบทความสำหรับนักพัฒนาบนอินเทอร์เน็ต เราจะใช้มันด้วย ตัวอย่างเช่น ถ้า "ฟีเจอร์ X รองรับโดย V8" แสดงว่ามันน่าจะทำงานใน Chrome, Opera และ Edge

```smart header="engine ทำงานอย่างไร?"

Engine นั้นซับซ้อน แต่พื้นฐานนั้นง่าย

1. Engine (ที่ฝังอยู่ในเบราว์เซอร์) อ่าน ("parse") สคริปต์
2. จากนั้นมันแปลง ("compile") สคริปต์เป็นโค้ดเครื่อง
3. และเครื่องก็รันโค้ดนั้น ค่อนข้างเร็ว

Engine จะใช้การปรับแต่งในทุกขั้นตอน มันยังเฝ้าดูสคริปต์ที่คอมไพล์แล้วในขณะรัน วิเคราะห์ข้อมูลที่ไหลผ่าน และปรับแต่งโค้ดเครื่องเพิ่มเติมตามความรู้นั้น
```

## JavaScript ในเบราว์เซอร์ทำอะไรได้บ้าง?

JavaScript สมัยใหม่เป็นภาษาโปรแกรมที่ "ปลอดภัย" มันไม่ได้ให้การเข้าถึงระดับต่ำไปยังหน่วยความจำหรือ CPU เพราะมันถูกสร้างขึ้นมาเพื่อเบราว์เซอร์ที่ไม่ต้องการมัน

ความสามารถของ JavaScript นั้นขึ้นอยู่กับสภาพแวดล้อมที่มันรันอยู่อย่างมาก ยกตัวอย่างเช่น [Node.js](https://wikipedia.org/wiki/Node.js) รองรับฟังก์ชันที่อนุญาตให้ JavaScript อ่าน/เขียนไฟล์ใดๆ ทำคำขอผ่านเน็ตเวิร์ค เป็นต้น

JavaScript ในเบราว์เซอร์สามารถทำทุกอย่างที่เกี่ยวข้องกับการจัดการหน้าเว็บ การโต้ตอบกับผู้ใช้ และเว็บเซิร์ฟเวอร์

ตัวอย่างเช่น JavaScript ในเบราว์เซอร์สามารถ:

- เพิ่ม HTML ใหม่เข้าไปในหน้า เปลี่ยนเนื้อหาที่มีอยู่ แก้ไขสไตล์
- ตอบสนองต่อการกระทำของผู้ใช้ ทำงานเมื่อคลิกเมาส์ เลื่อนเคอร์เซอร์ กดคีย์
- ส่งคำขอผ่านเน็ตเวิร์คไปยังเซิร์ฟเวอร์ระยะไกล ดาวน์โหลดและอัปโหลดไฟล์ (หรือที่เรียกว่าเทคโนโลยี [AJAX](https://en.wikipedia.org/wiki/Ajax_(programming)) และ [COMET](https://en.wikipedia.org/wiki/Comet_(programming)))
- ดึงและตั้งค่าคุกกี้ ถามคำถามผู้ใช้ แสดงข้อความ
- จดจำข้อมูลฝั่งไคลเอนต์ ("local storage")

## JavaScript ในเบราว์เซอร์ทำอะไรไม่ได้บ้าง?

ความสามารถของ JavaScript ในเบราว์เซอร์ถูกจำกัดด้วยเหตุผลด้านความปลอดภัยของผู้ใช้ จุดประสงค์คือเพื่อป้องกันหน้าเว็บที่ไม่ดีจากการเข้าถึงข้อมูลส่วนตัวหรือก่อให้เกิดความเสียหายแก่ข้อมูลของผู้ใช้

ตัวอย่างของข้อจำกัดเหล่านั้น ได้แก่:

- JavaScript บนหน้าเว็บอาจไม่สามารถอ่าน/เขียนไฟล์ใดๆ บนฮาร์ดดิสก์ คัดลอกมัน หรือรันโปรแกรมได้ มันไม่มีการเข้าถึงฟังก์ชันของระบบปฏิบัติการโดยตรง

    เบราว์เซอร์สมัยใหม่อนุญาตให้มันทำงานกับไฟล์ได้ แต่การเข้าถึงจะถูกจำกัดและจะให้ก็ต่อเมื่อผู้ใช้ทำการบางอย่าง เช่น "ลาก" ไฟล์เข้ามาในหน้าต่างเบราว์เซอร์ หรือเลือกมันผ่านแท็ก `<input>`

    มีวิธีโต้ตอบกับกล้อง/ไมโครโฟน และอุปกรณ์อื่นๆ แต่มันต้องการการอนุญาตจากผู้ใช้อย่างชัดแจ้ง ดังนั้นหน้าเว็บที่ใช้ JavaScript จะไม่สามารถเปิดเว็บแคมแอบๆ ดูสภาพแวดล้อมรอบๆ แล้วส่งข้อมูลไปให้ [NSA](https://en.wikipedia.org/wiki/National_Security_Agency) ได้
- แท็บ/วินโดว์ที่ต่างกันมักจะไม่รู้อะไรเกี่ยวกับกันและกัน บางครั้งก็รู้ เช่นเมื่อหน้าต่างหนึ่งใช้ JavaScript เปิดอีกหน้าต่างหนึ่ง แต่แม้แต่ในกรณีนี้ JavaScript จากหน้าหนึ่งก็อาจไม่สามารถเข้าถึงอีกหน้าได้ หากมาจากไซต์ที่ต่างกัน (จากโดเมน โปรโตคอล หรือพอร์ตที่ต่างกัน)

    เรียกว่า "Same Origin Policy" ในการทำงาน *ทั้งสองหน้า* ต้องตกลงกันให้มีการแลกเปลี่ยนข้อมูล และต้องมีโค้ด JavaScript พิเศษสำหรับจัดการมัน เราจะกล่าวถึงเรื่องนี้ในบทเรียน

    ข้อจำกัดนี้ก็เพื่อความปลอดภัยของผู้ใช้อีกเช่นกัน หน้าจาก `http://anysite.com` ที่ผู้ใช้เปิดอยู่ไม่ควรสามารถเข้าถึงอีกแท็บของเบราว์เซอร์ที่มี URL เป็น `http://gmail.com` ได้ ตัวอย่างเช่นการขโมยข้อมูลจากที่นั่น
- JavaScript สามารถติดต่อสื่อสารผ่านเน็ตกับเซิร์ฟเวอร์ที่หน้าปัจจุบันมาจากได้อย่างง่ายดาย แต่ความสามารถในการรับข้อมูลจากไซต์/โดเมนอื่นๆ นั้นอ่อนแอ แม้ว่าจะทำได้ แต่ก็ต้องมีข้อตกลงชัดเจน (แสดงใน HTTP header) จากฝั่งเซิร์ฟเวอร์ระยะไกล อีกครั้ง นี่เป็นข้อจำกัดด้านความปลอดภัย

![](limitations.svg)

ข้อจำกัดเหล่านี้ไม่มีหากใช้ JavaScript นอกเบราว์เซอร์ ตัวอย่างเช่นบนเซิร์ฟเวอร์ เบราว์เซอร์สมัยใหม่ก็อนุญาตให้ปลั๊กอิน/ส่วนขยายขอสิทธิ์เพิ่มเติมได้

## อะไรทำให้ JavaScript มีเอกลักษณ์?

JavaScript มีอย่างน้อย *สาม* สิ่งที่ยอดเยี่ยม:

```compare
+ การผสานรวมกับ HTML/CSS อย่างเต็มที่
+ สิ่งง่ายๆ ก็ทำได้ง่ายๆ 
+ รองรับโดยเบราว์เซอร์หลักทั้งหมด และเปิดใช้งานโดยค่าเริ่มต้น
```
JavaScript เป็นเทคโนโลยีของเบราว์เซอร์เพียงอย่างเดียวที่รวมสามสิ่งนี้เข้าด้วยกัน

นั่นคือสิ่งที่ทำให้ JavaScript มีเอกลักษณ์ นั่นคือเหตุผลที่ทำให้มันเป็นเครื่องมือที่แพร่หลายมากที่สุดสำหรับการสร้างอินเตอร์เฟซของเบราว์เซอร์

อย่างไรก็ตาม JavaScript สามารถใช้สร้างเซิร์ฟเวอร์ แอปพลิเคชันมือถือ เป็นต้น

## ภาษาที่ถูก "transpiled" เป็น JavaScript

ไวยากรณ์ของ JavaScript ไม่เหมาะกับความต้องการของทุกคน คนแต่ละคนต้องการฟีเจอร์ที่แตกต่างกัน

นั่นเป็นเรื่องที่คาดหวังได้ เพราะโปรเจ็กต์และความต้องการของแต่ละคนนั้นต่างกัน

ดังนั้น เมื่อไม่นานมานี้จึงมีภาษาใหม่ๆ มากมายเกิดขึ้น ซึ่งจะถูก *transpiled* (แปลง) เป็น JavaScript ก่อนที่จะรันในเบราว์เซอร์

เครื่องมือสมัยใหม่ทำให้การ transpile มีความเร็วสูงและโปร่งใส ทำให้นักพัฒนาสามารถเขียนโค้ดในภาษาอื่น และแปลงมันเป็น JavaScript โดยอัตโนมัติ "เบื้องหลัง"

ตัวอย่างของภาษาเหล่านั้น:

- [CoffeeScript](https://coffeescript.org/) คือ "syntactic sugar" สำหรับ JavaScript มันแนะนำไวยากรณ์ที่สั้นกว่า ช่วยให้เราเขียนโค้ดที่ชัดเจนและแม่นยำกว่า ปกตินักพัฒนา Ruby ชอบมัน
- [TypeScript](https://www.typescriptlang.org/) เน้นที่การเพิ่ม "strict data typing" เพื่อทำให้การพัฒนาและสนับสนุนระบบที่ซับซ้อนง่ายขึ้น พัฒนาโดย Microsoft
- [Flow](https://flow.org/) ก็เพิ่ม data typing เหมือนกัน แต่ในแบบที่แตกต่าง พัฒนาโดย Facebook
- [Dart](https://www.dartlang.org/) เป็นภาษาแบบแยกต่างหากที่มี engine ของตัวเอง สามารถรันในสภาพแวดล้อมที่ไม่ใช่เบราว์เซอร์ (เช่นแอปมือถือ) แต่ก็สามารถ transpile เป็น JavaScript ได้ พัฒนาโดย Google
- [Brython](https://brython.info/) เป็น Python transpiler ไปยัง JavaScript ที่ช่วยให้เขียนแอปพลิเคชันด้วย pure Python โดยไม่ต้องใช้ JavaScript
- [Kotlin](https://kotlinlang.org/docs/reference/js-overview.html) เป็นภาษาโปรแกรมสมัยใหม่ที่กระชับและปลอดภัย สามารถกำหนดเป้าหมายไปที่เบราว์เซอร์หรือ Node

ยังมีอีกมาก แน่นอนว่าแม้จะใช้ภาษาที่ถูก transpile มาเหล่านี้ เราก็ยังควรรู้ JavaScript ด้วยเพื่อให้เข้าใจอย่างแท้จริงว่ากำลังทำอะไรอยู่

## สรุป

- JavaScript ถูกสร้างขึ้นมาเพื่อเป็นภาษาสำหรับเบราว์เซอร์อย่างเดียว แต่ตอนนี้ก็ถูกใช้ในสภาพแวดล้อมอื่นๆ อีกมาก
- ปัจจุบัน JavaScript มีตำแหน่งที่ไม่เหมือนใครในฐานะภาษาของเบราว์เซอร์ที่รับการยอมรับอย่างกว้างขวางที่สุด สามารถผสานรวมกับ HTML/CSS ได้อย่างเต็มที่
- มีหลายภาษาที่ "transpiled" เป็น JavaScript และมีฟีเจอร์บางอย่าง แนะนำให้ลองดูภาษาเหล่านี้ อย่างน้อยก็คร่าวๆ หลังจากเรียนรู้ JavaScript จนเชี่ยวชาญแล้ว
